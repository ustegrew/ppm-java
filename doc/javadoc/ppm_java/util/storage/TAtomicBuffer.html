<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_111) on Thu Jan 12 18:06:21 GMT 2017 -->
<title>TAtomicBuffer</title>
<meta name="date" content="2017-01-12">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TAtomicBuffer";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TAtomicBuffer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../ppm_java/util/storage/TAtomicArrayMap.html" title="class in ppm_java.util.storage"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?ppm_java/util/storage/TAtomicBuffer.html" target="_top">Frames</a></li>
<li><a href="TAtomicBuffer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">ppm_java.util.storage</div>
<h2 title="Class TAtomicBuffer" class="title">Class TAtomicBuffer</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>ppm_java.util.storage.TAtomicBuffer</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">TAtomicBuffer</span>
extends java.lang.Object</pre>
<div class="block">An atomic-access wrapper around a <code>FloatBuffer</code>. Designed 
 for situations where we need to transport data between a high priority
 thread and a low priority thread in a producer-consumer scenario. 
 Example scenario: A thread operating audio hardware sends audio sample data 
 to another thread updating the GUI. The audio hardware thread cannot 
 afford to be blocked, hence has high priority. The GUI thread isn't time 
 critical, and we can afford to have it loose some data. 
 <p><br/></p>
 
 The <code>TAtomicBuffer</code> guarantees that data can be passed from (to)
 a high priority thread within a fixed (short) time without 
 blocking it. This comes at a cost - the associated low priority thread 
 does not have the guarantee that all data actually reaches it - in highly 
 contended situations the <code>TAtomicBuffer</code> would simply drop
 data where the low priority thread cannot keep up. If the low priority 
 thread can't keep up with the streaming data it can't make full use of 
 the stream anyway, so this seemed to be the best solution for data in 
 contention situations.
 <p><br/></p>
 
 The <code>TAtomicBuffer</code> copies the incoming data frames before 
 they are passed on to the consumer. This is to protect the producer. 
 If we pass on uncopied data frames and the consumer side does changes 
 to the data then those changes would be seen on the producer side as 
 well and cause unforeseen side effects and hard to track down errors.
 The extra protection comes with a performance penalty as the copying
 costs time. To protect the time critical thread from the performance loss
 we can set the time point at which the data is copied. If the producer
 is the time critical we copy when the consumer fetches. If the consumer is
 time critical we copy when the producer sets it. In some situations 
 the data copy may be unnecessary in which case we 
 can instruct the atomic buffer to omit any data copying. However, due 
 to the real possibility of data corruption the data must then be copied
 separately, either on the producer or on the consumer side. The copy
 actions can be set at construction time via the <code>copyPolicy</code>
 parameter.  
 
 To monitor the quality of the data flow we offer various counters which can 
 be queried by all parties (all <code>clearable</code>}:
 <p><br/></p>
 
 <ul>
     <li>Overrun counter:    Increments each time the producer pushes a new 
                             packet whilst an old packet still awaits collection 
                             by the consumer. A steady increase of the overruns 
                             indicates that the consumer can't keep up with the 
                             producer and looses packets.</li>
     <li>Underrun counter:   Increments each time the consumer requests a packet
                             whilst none has been pushed since the last collection.
                             A steady increase of underruns indicates that the 
                             producer can't keep up with the consumer.</li>
     <li>Contention counter: Increments each time the producer and the consumer are
                             both trying to acquire access to the buffer at the 
                             same time. A steady increase of the contentions 
                             indicates that both, producer and consumer, are too 
                             aggressive trying to set and get data.</li>
 </ul>
 <p><br/></p>
 
 Clients can use the underrun and overrun counters for automatic dropout compensation. 
 For example, a low priority consumer thread can, with each cycle: 
 <ul>
     <li>read overrun and underrun counts</li>
     <li>compute the difference: <code>d = nOver - nUnder</code>. If
         <code>d</code> is zero: All is well. If it's negative: Underruns. 
         If it's positive: Overruns.</li>
     <li>then compensate by adjusting the time to the next cycle:</li>
     <li>
         <ul>
             <li><code>d == 0</code>: No adjustment.</li>
             <li><code>d  < 0</code>: Underruns! Decrease read frequency => 
                                      Increase cycle time by a fixed number of milliseconds.</li>
             <li><code>d  > 0</code>: Overruns! Increase read frequency => 
                                      Decrease cycle time by a fixed number of milliseconds.</li>
         </ul>
     </li>
 </ul>
 <p><br/></p>
 
 If the contention counter has a steep rise then both, the producer and consumer are
 too aggressively trying to set and read data. As a mitigation strategy the party with the 
 lower priority must be forced to yield whilst the higher priority party has the critical section.
 You can use the <a href="../../../ppm_java/util/storage/TAtomicBuffer.html#IsLocked--"><code>IsLocked()</code></a> method for that:
 <p><br/></p>
 
 <pre>
 while (myBuffer.IsLocked()) 
 {
     try 
     {
         Thread.sleep (2);
     } catch (ThatInterruptedExceptionISeeNoUseFor e){}
 }
 </pre>
 <p><br/></p>
 
 This is not a pretty solution, but it works - best use sparingly, if you have to. 
 <p><br/></p>
 
 Don't assume the counters are precise. Overall access to the counters isn't thread safe
 (it seemed overkill to implement that, too). Whilst each counter is using an atomic 
 integer (and should be thread safe by itself), we still can have scenarios such as one
 thread incrementing the underrun counter whilst another thread reads the overrun counter.
 Due to lack of overall counter thread safety the counters can only serve as guideline 
 to assess the various reasons for dropped data. Them counters aren't brilliant, but good 
 enough for simple diagnosis.
 <p><br/></p>
 
 Clients can customize what's returned to the consumer thread when no valid data is 
 available upon call to <a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Get--"><code>Get()</code></a>. Default is to return an empty sample chunk
 (in effect saying - zero samples available). But it means that for every invalid 
 <a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Get--"><code>Get()</code></a> call we create a new empty <code>FloatBuffer</code> which doesn't really 
 feel that good. Therefore there's also the possibility to have <a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Get--"><code>Get()</code></a> 
 return <code>null</code> which allows consumers to operate in a similar fashion 
 as it's done with <code>AtomicInteger.compareAndSet(int, int)</code>:
 <p><br/></p>
 
 <pre>
 // At some place: 
 TAtomicBuffer myBuf = new TAtomicBuffer (ECopyPolicy.kCopyOnGet, EIfInvalidPolicy.kReturnNull)
 
 // Inside consumer thread
 do
 {
     chunk = myBuf.Get ();
     try {
     Thread.sleep (yieldTime); // Can be a few mSec so the processor doesn't grind to a halt.
     } catch (ThatInterruptedExceptionISeeNoUseFor e){}
 } while (chunk == null);
 
 // Now do nifty stuff with the sample chunk. 
 </pre>
 <p><br/></p>
 
 For synchronization between producer and consumer the <code>TAtomicBuffer</code>
 makes use of an <code>AtomicInteger</code> flag; more specifically, the 
 <code>AtomicInteger.compareAndSet(int, int)</code> method. This method is guaranteed 
 to be atomic, i.e. allow access to the enclosed integer only by a single thread at
 a time without blocking the other threads. We don't use the standard 
 <code>synchronized</code> mutex as that one does block threads which haven't
 acquired it. This can block the time critical thread, leading to priority inversion
 (where the low priority thread blocks the high priority one). Additionally, 
 on some platforms the <code>synchronized</code> primitive is quite costly, i.e.
 time consuming. The <code>AtomicInteger.compareAndSet(int, int)</code> is much faster.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>peter</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a></span></code>
<div class="block">The Copy policy.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a></span></code>
<div class="block">The Invalid data policy.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.nio.FloatBuffer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fBuffer">fBuffer</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fCopyPolicy">fCopyPolicy</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.concurrent.atomic.AtomicInteger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fFlag">fFlag</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fHasBeenCollected">fHasBeenCollected</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fIfInvalidPolicy">fIfInvalidPolicy</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage">TAtomicBuffer_Stats</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#fStats">fStats</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#gkFree">gkFree</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#gkLocked">gkLocked</a></span></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#TAtomicBuffer--">TAtomicBuffer</a></span>()</code>
<div class="block">Creates a new atomic buffer with default policies:
 
     <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html#kCopyOnSet"><code>TAtomicBuffer.ECopyPolicy.kCopyOnSet</code></a>
     <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a>
 </div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#TAtomicBuffer-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-">TAtomicBuffer</a></span>(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy)</code>
<div class="block">Creates a new atomic buffer with a custom <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage"><code>TAtomicBuffer.ECopyPolicy</code></a> and 
 default <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#TAtomicBuffer-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-ppm_java.util.storage.TAtomicBuffer.EIfInvalidPolicy-">TAtomicBuffer</a></span>(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy,
             <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a>&nbsp;ifInvalidPolicy)</code>
<div class="block">Creates a new atomic buffer with a custom <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage"><code>TAtomicBuffer.ECopyPolicy</code></a> and 
 default <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a>.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private java.nio.FloatBuffer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_DataGet-boolean-">_DataGet</a></span>(boolean&nbsp;doCopy)</code>
<div class="block">An internal work method: Retrieves (a deep copy of) the newest sample chunk,
 or empty chunk, resp.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_DataSet-java.nio.FloatBuffer-boolean-">_DataSet</a></span>(java.nio.FloatBuffer&nbsp;fb,
        boolean&nbsp;doCopy)</code>
<div class="block">Store (a copy of the) new sample chunk, whether the consumer collected or not.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>private java.nio.FloatBuffer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_GetDeepCopy-java.nio.FloatBuffer-">_GetDeepCopy</a></span>(java.nio.FloatBuffer&nbsp;fb)</code>
<div class="block">Creates a deep copy of the passed float buffer (for copy-on-write semantics).</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_Init-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-ppm_java.util.storage.TAtomicBuffer.EIfInvalidPolicy-">_Init</a></span>(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy,
     <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a>&nbsp;ifInvalidPolicy)</code>
<div class="block">Common initialization method - used by the various cTors.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_Lock--">_Lock</a></span>()</code>
<div class="block">Definitely acquire the lock on the critical section (spin lock, as it's 
 merry-go-round until lock has been acquired).</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_TryLock--">_TryLock</a></span>()</code>
<div class="block">Tentatively try to lock the critical section.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Z:Z_Unlock--">_Unlock</a></span>()</code>
<div class="block">Definitely unlock the critical section (spin lock, as it's 
 merry-go-round until lock has been released).</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.nio.FloatBuffer</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Get--">Get</a></span>()</code>
<div class="block">Returns the newest sample data.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#IsLocked--">IsLocked</a></span>()</code>
<div class="block">Returns <code>true</code> if the critical section is locked.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#Set-java.nio.FloatBuffer-">Set</a></span>(java.nio.FloatBuffer&nbsp;fb)</code>
<div class="block">Sets the new sample chunk.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#StatsClear--">StatsClear</a></span>()</code>
<div class="block">Clears the associated runtime statistics.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage">TAtomicBuffer_Stats</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../ppm_java/util/storage/TAtomicBuffer.html#StatsGet--">StatsGet</a></span>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="gkFree">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>gkFree</h4>
<pre>private static final&nbsp;int gkFree</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#ppm_java.util.storage.TAtomicBuffer.gkFree">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="gkLocked">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>gkLocked</h4>
<pre>private static final&nbsp;int gkLocked</pre>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../constant-values.html#ppm_java.util.storage.TAtomicBuffer.gkLocked">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="fBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fBuffer</h4>
<pre>private&nbsp;java.nio.FloatBuffer fBuffer</pre>
</li>
</ul>
<a name="fCopyPolicy">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fCopyPolicy</h4>
<pre>private&nbsp;<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a> fCopyPolicy</pre>
</li>
</ul>
<a name="fFlag">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fFlag</h4>
<pre>private&nbsp;java.util.concurrent.atomic.AtomicInteger fFlag</pre>
</li>
</ul>
<a name="fHasBeenCollected">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fHasBeenCollected</h4>
<pre>private&nbsp;boolean fHasBeenCollected</pre>
</li>
</ul>
<a name="fIfInvalidPolicy">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fIfInvalidPolicy</h4>
<pre>private&nbsp;<a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a> fIfInvalidPolicy</pre>
</li>
</ul>
<a name="fStats">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>fStats</h4>
<pre>private&nbsp;<a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage">TAtomicBuffer_Stats</a> fStats</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TAtomicBuffer--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TAtomicBuffer</h4>
<pre>public&nbsp;TAtomicBuffer()</pre>
<div class="block">Creates a new atomic buffer with default policies:
 <ul>
     <li><a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html#kCopyOnSet"><code>TAtomicBuffer.ECopyPolicy.kCopyOnSet</code></a></li>
     <li><a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a></li>
 </ul></div>
</li>
</ul>
<a name="TAtomicBuffer-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TAtomicBuffer</h4>
<pre>public&nbsp;TAtomicBuffer(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy)</pre>
<div class="block">Creates a new atomic buffer with a custom <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage"><code>TAtomicBuffer.ECopyPolicy</code></a> and 
 default <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>copyPolicy</code> - The desired copy policy. Determines which thread
                          is treated as high priority thread, and which one as 
                          low priority thread.</dd>
</dl>
</li>
</ul>
<a name="TAtomicBuffer-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-ppm_java.util.storage.TAtomicBuffer.EIfInvalidPolicy-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TAtomicBuffer</h4>
<pre>public&nbsp;TAtomicBuffer(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy,
                     <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a>&nbsp;ifInvalidPolicy)</pre>
<div class="block">Creates a new atomic buffer with a custom <a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage"><code>TAtomicBuffer.ECopyPolicy</code></a> and 
 default <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html#kReturnEmpty"><code>TAtomicBuffer.EIfInvalidPolicy.kReturnEmpty</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>copyPolicy</code> - The desired copy policy. Determines which thread
                          is treated as high priority thread, and which one as 
                          low priority thread.</dd>
<dd><code>ifInvalidPolicy</code> - The desired invalid data policy. Determines what is 
                          returned to the consumer thread when there's no valid
                          data.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="Get--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Get</h4>
<pre>public&nbsp;java.nio.FloatBuffer&nbsp;Get()</pre>
<div class="block">Returns the newest sample data. Meant for the consumer thread.
 Note that at some stage there's a deep copying;
 therefore we will never return the original <code>FloatBuffer</code> object. 
 <p><br/></p>

 If there was no new sample data (i.e. stale data = that particular chunk has 
 already been collected before) or if there was contention with the producer
 thread then we'll return either an empty sample chunk or null. See 
 <a href="../../../ppm_java/util/storage/TAtomicBuffer.html" title="class in ppm_java.util.storage"><code>introduction</code></a> for further information.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The newest sample data, or empty chunk, resp. <code>null</code>.</dd>
</dl>
</li>
</ul>
<a name="StatsClear--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>StatsClear</h4>
<pre>public&nbsp;void&nbsp;StatsClear()</pre>
<div class="block">Clears the associated runtime statistics.
 Not thread safe, but good enough to use 
 for automatic compensation of problems.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage"><code>TAtomicBuffer_Stats</code></a></dd>
</dl>
</li>
</ul>
<a name="StatsGet--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>StatsGet</h4>
<pre>public&nbsp;<a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage">TAtomicBuffer_Stats</a>&nbsp;StatsGet()</pre>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The associated runtime statistics.
              Not thread safe, but good enough to use 
              for automatic compensation of problems.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage"><code>TAtomicBuffer_Stats</code></a></dd>
</dl>
</li>
</ul>
<a name="IsLocked--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>IsLocked</h4>
<pre>public&nbsp;boolean&nbsp;IsLocked()</pre>
<div class="block">Returns <code>true</code> if the critical section is locked. 
 It's not thread-safe because by the time the result is returned
 the blocking thread may already have (un)locked the critical 
 section. However, it's good enough to be used for automatic 
 resolution of high contention situations. See the 
 <a href="../../../ppm_java/util/storage/TAtomicBuffer.html" title="class in ppm_java.util.storage"><code>introduction</code></a> for an automated strategy to 
 reduce contentions.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if the critical section is locked right now.</dd>
</dl>
</li>
</ul>
<a name="Set-java.nio.FloatBuffer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>Set</h4>
<pre>public&nbsp;void&nbsp;Set(java.nio.FloatBuffer&nbsp;fb)</pre>
<div class="block">Sets the new sample chunk. If there is stale data it will be overwritten.
 Meant for the producer thread.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fb</code> - Sample chunk to set.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_DataGet-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_DataGet</h4>
<pre>private&nbsp;java.nio.FloatBuffer&nbsp;_DataGet(boolean&nbsp;doCopy)</pre>
<div class="block">An internal work method: Retrieves (a deep copy of) the newest sample chunk,
 or empty chunk, resp. <code>null</code> if there's stale data. If there was
 just stale data we will increment the underrun counter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>doCopy</code> - Return a deep copy, not the original FloatBuffer object.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The (deep copy of the) latest sample chunk.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_DataSet-java.nio.FloatBuffer-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_DataSet</h4>
<pre>private&nbsp;void&nbsp;_DataSet(java.nio.FloatBuffer&nbsp;fb,
                      boolean&nbsp;doCopy)</pre>
<div class="block">Store (a copy of the) new sample chunk, whether the consumer collected or not. 
 If there was stale data (i.e. uncollected since last _DataSet(..)
 we will increment the overrun counter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fb</code> - The sample chunk to be stored.</dd>
<dd><code>doCopy</code> - If <code>true</code>, store a deep copy instead of
                  the original.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_GetDeepCopy-java.nio.FloatBuffer-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_GetDeepCopy</h4>
<pre>private&nbsp;java.nio.FloatBuffer&nbsp;_GetDeepCopy(java.nio.FloatBuffer&nbsp;fb)</pre>
<div class="block">Creates a deep copy of the passed float buffer (for copy-on-write semantics).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fb</code> - The <code>FloatBuffer</code> to be copied.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The deep copy. Essentially, this is a new (separate) object.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_Init-ppm_java.util.storage.TAtomicBuffer.ECopyPolicy-ppm_java.util.storage.TAtomicBuffer.EIfInvalidPolicy-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_Init</h4>
<pre>private&nbsp;void&nbsp;_Init(<a href="../../../ppm_java/util/storage/TAtomicBuffer.ECopyPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.ECopyPolicy</a>&nbsp;copyPolicy,
                   <a href="../../../ppm_java/util/storage/TAtomicBuffer.EIfInvalidPolicy.html" title="enum in ppm_java.util.storage">TAtomicBuffer.EIfInvalidPolicy</a>&nbsp;ifInvalidPolicy)</pre>
<div class="block">Common initialization method - used by the various cTors.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>copyPolicy</code> - The copy policy.</dd>
<dd><code>ifInvalidPolicy</code> - The "what do I return if no good data" policy.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_Lock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_Lock</h4>
<pre>private&nbsp;void&nbsp;_Lock()</pre>
<div class="block">Definitely acquire the lock on the critical section (spin lock, as it's 
 merry-go-round until lock has been acquired).</div>
</li>
</ul>
<a name="Z:Z_TryLock--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>_TryLock</h4>
<pre>private&nbsp;boolean&nbsp;_TryLock()</pre>
<div class="block">Tentatively try to lock the critical section.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd><code>true</code> if lock acquired, <code>false</code> if acquiring failed.</dd>
</dl>
</li>
</ul>
<a name="Z:Z_Unlock--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>_Unlock</h4>
<pre>private&nbsp;void&nbsp;_Unlock()</pre>
<div class="block">Definitely unlock the critical section (spin lock, as it's 
 merry-go-round until lock has been released).</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/TAtomicBuffer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../ppm_java/util/storage/TAtomicArrayMap.html" title="class in ppm_java.util.storage"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../ppm_java/util/storage/TAtomicBuffer_Stats.html" title="class in ppm_java.util.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?ppm_java/util/storage/TAtomicBuffer.html" target="_top">Frames</a></li>
<li><a href="TAtomicBuffer.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
